function imgError(e){e.onerror=null,setTimeout(function(){e.src=e.src},3e3)}$(window).on("load",function(){$("body").removeClass("no-transitions")}),$(function(){function e(){var e=$(window).height()-$(".page-container").offset().top-$(".navbar-fixed-bottom").outerHeight();$(".page-container").attr("style","min-height:"+e+"px")}$("body").addClass("no-transitions"),e(),$(".panel-heading, .page-header-content, .panel-body, .panel-footer").has("> .heading-elements").append('<a class="heading-elements-toggle"><i class="icon-more"></i></a>'),$(".heading-elements-toggle").on("click",function(){$(this).parent().children(".heading-elements").toggleClass("visible")}),$(".breadcrumb-line").has(".breadcrumb-elements").append('<a class="breadcrumb-elements-toggle"><i class="icon-menu-open"></i></a>'),$(".breadcrumb-elements-toggle").on("click",function(){$(this).parent().children(".breadcrumb-elements").toggleClass("visible")}),$(document).on("click",".dropdown-content",function(e){e.stopPropagation()}),$(".navbar-nav .disabled a").on("click",function(e){e.preventDefault(),e.stopPropagation()}),$('.dropdown-content a[data-toggle="tab"]').on("click",function(){$(this).tab("show")}),$(".panel [data-action=reload]").click(function(e){e.preventDefault();var t=$(this).parent().parent().parent().parent().parent();$(t).block({message:'<i class="icon-spinner2 spinner"></i>',overlayCSS:{backgroundColor:"#fff",opacity:.8,cursor:"wait","box-shadow":"0 0 0 1px #ddd"},css:{border:0,padding:0,backgroundColor:"none"}}),window.setTimeout(function(){$(t).unblock()},2e3)}),$(".category-title [data-action=reload]").click(function(e){e.preventDefault();var t=$(this).parent().parent().parent().parent();$(t).block({message:'<i class="icon-spinner2 spinner"></i>',overlayCSS:{backgroundColor:"#000",opacity:.5,cursor:"wait","box-shadow":"0 0 0 1px #000"},css:{border:0,padding:0,backgroundColor:"none",color:"#fff"}}),window.setTimeout(function(){$(t).unblock()},2e3)}),$(".sidebar-default .category-title [data-action=reload]").click(function(e){e.preventDefault();var t=$(this).parent().parent().parent().parent();$(t).block({message:'<i class="icon-spinner2 spinner"></i>',overlayCSS:{backgroundColor:"#fff",opacity:.8,cursor:"wait","box-shadow":"0 0 0 1px #ddd"},css:{border:0,padding:0,backgroundColor:"none"}}),window.setTimeout(function(){$(t).unblock()},2e3)}),$(".category-collapsed").children(".category-content").hide(),$(".category-collapsed").find("[data-action=collapse]").addClass("rotate-180"),$(".category-title [data-action=collapse]").click(function(t){t.preventDefault();var i=$(this).parent().parent().parent().nextAll();$(this).parents(".category-title").toggleClass("category-collapsed"),$(this).toggleClass("rotate-180"),e(),i.slideToggle(150)}),$(".panel-collapsed").children(".panel-heading").nextAll().hide(),$(".panel-collapsed").find("[data-action=collapse]").addClass("rotate-180"),$(".panel [data-action=collapse]").click(function(t){t.preventDefault();var i=$(this).parent().parent().parent().parent().nextAll();$(this).parents(".panel").toggleClass("panel-collapsed"),$(this).toggleClass("rotate-180"),e(),i.slideToggle(150)}),$(".panel [data-action=close]").click(function(t){t.preventDefault();var i=$(this).parent().parent().parent().parent().parent();e(),i.slideUp(150,function(){$(this).remove()})}),$(".category-title [data-action=close]").click(function(t){t.preventDefault();var i=$(this).parent().parent().parent().parent();e(),i.slideUp(150,function(){$(this).remove()})}),$(".navigation").find("li.active").parents("li").addClass("active"),$(".navigation").find("li").not(".active, .category-title").has("ul").children("ul").addClass("hidden-ul"),$(".navigation").find("li").has("ul").children("a").addClass("has-ul"),$(".dropdown-menu:not(.dropdown-content), .dropdown-menu:not(.dropdown-content) .dropdown-submenu").has("li.active").addClass("active").parents(".navbar-nav .dropdown:not(.language-switch), .navbar-nav .dropup:not(.language-switch)").addClass("active"),$(".navigation-main > .navigation-header > i").tooltip({placement:"right",container:"body"}),$(".navigation-main").find("li").has("ul").children("a").on("click",function(e){e.preventDefault(),$(this).parent("li").not(".disabled").not($(".sidebar-xs").not(".sidebar-xs-indicator").find(".navigation-main").children("li")).toggleClass("active").children("ul").slideToggle(250),$(".navigation-main").hasClass("navigation-accordion")&&$(this).parent("li").not(".disabled").not($(".sidebar-xs").not(".sidebar-xs-indicator").find(".navigation-main").children("li")).siblings(":has(.has-ul)").removeClass("active").children("ul").slideUp(250)}),$(".navigation-alt").find("li").has("ul").children("a").on("click",function(e){e.preventDefault(),$(this).parent("li").not(".disabled").toggleClass("active").children("ul").slideToggle(200),$(".navigation-alt").hasClass("navigation-accordion")&&$(this).parent("li").not(".disabled").siblings(":has(.has-ul)").removeClass("active").children("ul").slideUp(200)}),$(".sidebar-main-toggle").on("click",function(e){e.preventDefault(),$("body").toggleClass("sidebar-xs")}),$(document).on("click",".navigation .disabled a",function(e){e.preventDefault()}),$(document).on("click",".sidebar-control",function(){e()}),$(document).on("click",".sidebar-main-hide",function(e){e.preventDefault(),$("body").toggleClass("sidebar-main-hidden")}),$(document).on("click",".sidebar-secondary-hide",function(e){e.preventDefault(),$("body").toggleClass("sidebar-secondary-hidden")}),$(document).on("click",".sidebar-all-hide",function(e){e.preventDefault(),$("body").toggleClass("sidebar-all-hidden")}),$(document).on("click",".sidebar-opposite-toggle",function(e){e.preventDefault(),$("body").toggleClass("sidebar-opposite-visible"),$("body").hasClass("sidebar-opposite-visible")?($("body").addClass("sidebar-xs"),$(".navigation-main").children("li").children("ul").css("display","")):$("body").removeClass("sidebar-xs")}),$(document).on("click",".sidebar-opposite-main-hide",function(e){e.preventDefault(),$("body").toggleClass("sidebar-opposite-visible"),$("body").hasClass("sidebar-opposite-visible")?$("body").addClass("sidebar-main-hidden"):$("body").removeClass("sidebar-main-hidden")}),$(document).on("click",".sidebar-opposite-secondary-hide",function(e){e.preventDefault(),$("body").toggleClass("sidebar-opposite-visible"),$("body").hasClass("sidebar-opposite-visible")?$("body").addClass("sidebar-secondary-hidden"):$("body").removeClass("sidebar-secondary-hidden")}),$(document).on("click",".sidebar-opposite-hide",function(e){e.preventDefault(),$("body").toggleClass("sidebar-all-hidden"),$("body").hasClass("sidebar-all-hidden")?($("body").addClass("sidebar-opposite-visible"),$(".navigation-main").children("li").children("ul").css("display","")):$("body").removeClass("sidebar-opposite-visible")}),$(document).on("click",".sidebar-opposite-fix",function(e){e.preventDefault(),$("body").toggleClass("sidebar-opposite-visible")}),$(".sidebar-mobile-main-toggle").on("click",function(e){e.preventDefault(),$("body").toggleClass("sidebar-mobile-main").removeClass("sidebar-mobile-secondary sidebar-mobile-opposite")}),$(".sidebar-mobile-secondary-toggle").on("click",function(e){e.preventDefault(),$("body").toggleClass("sidebar-mobile-secondary").removeClass("sidebar-mobile-main sidebar-mobile-opposite")}),$(".sidebar-mobile-opposite-toggle").on("click",function(e){e.preventDefault(),$("body").toggleClass("sidebar-mobile-opposite").removeClass("sidebar-mobile-main sidebar-mobile-secondary")}),$(window).on("resize",function(){setTimeout(function(){e(),$(window).width()<=768?($("body").addClass("sidebar-xs-indicator"),$(".sidebar-opposite").prependTo(".page-content")):($("body").removeClass("sidebar-xs-indicator"),$(".sidebar-opposite").insertAfter(".content-wrapper"),$("body").removeClass("sidebar-mobile-main sidebar-mobile-secondary sidebar-mobile-opposite"))},100)}).resize(),$('[data-popup="popover"]').popover(),$('[data-popup="tooltip"]').tooltip()});var my_decoder=function(e,t,i,o,n){return 401==i.status?void(window.location.href="/signIn"):void(e.success===!0?(console.log(e.data),o(e.success,e.data)):(console.log(e.message),n(e.success,e.message)))};amplify.request.define("articleReactionPOST","ajax",{url:"/articles/reaction",dataType:"json",type:"POST",contentType:"application/json",decoder:my_decoder}),amplify.request.define("articleCommentPOST","ajax",{url:"/comments",dataType:"json",type:"POST",contentType:"application/json",decoder:function(e,t,i,o){return 401==i.status?void(window.location.href="/signIn"):void(i.responseText&&o(i.responseText))}}),amplify.request.define("subCommentPOST","ajax",{url:"/subComments",dataType:"json",type:"POST",contentType:"application/json",decoder:function(e,t,i,o){return 401==i.status?void(window.location.href="/signIn"):void(i.responseText&&o(i.responseText))}}),amplify.request.define("commentPUT","ajax",{url:"/comments",dataType:"json",type:"PUT",contentType:"application/json",decoder:function(e,t,i,o){return 401==i.status?void(window.location.href="/signIn"):void(i.responseText&&o(i.responseText))}}),amplify.request.define("commentReactionPOST","ajax",{url:"/comments/reaction",dataType:"json",type:"POST",contentType:"application/json",decoder:my_decoder}),amplify.request.define("newShowMoreArticlesGET","ajax",{url:"/articles/new/{pageNumber}",contentType:"application/json",type:"GET"}),amplify.request.define("newShowMoreUserArticlesGET","ajax",{url:"/user/{userID}/articles/new/{pageNumber}",contentType:"application/json",type:"GET"}),amplify.request.define("hotShowMoreArticlesGET","ajax",{url:"/articles/hot/{pageNumber}",contentType:"application/json",type:"GET"}),amplify.request.define("newShowMoreCommentsGET","ajax",{url:"/articles/{articleID}/comments/new/{pageNumber}",contentType:"application/json",type:"GET"}),amplify.request.define("hotShowMoreCommentsGET","ajax",{url:"/articles/{articleID}/comments/hot/{pageNumber}",contentType:"application/json",type:"GET"}),amplify.request.define("hotShowMoreSubCommentsGET","ajax",{url:"/articles/{articleID}/comments/{commentID}/subComments/hot",contentType:"application/json",type:"GET"}),amplify.request.define("adminUsers_list_request","ajax",{url:"/admin/users/list",dataType:"json",type:"GET",contentType:"application/json",decoder:my_decoder,beforeSend:function(e){e.setRequestHeader("X-Auth-Token",amplify.store("_auth_token"))}}),$(function(){function e(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){$("#image_upload_preview").attr("src",e.target.result)},t.readAsDataURL(e.files[0])}}$("#inputFile").on("change",function(){e(this)})}),$(function(){var e=document.getElementById("commentReplyInputTemplate").innerHTML,t=document.getElementById("modalCommentEditContentTemplate").innerHTML,i=document.getElementById("userNotificationListTemplate").innerHTML;$("#contentList").on("click","button.like",function(){var e=$(this).attr("id").slice(0,-5);amplify.publish("like_ui",e),amplify.publish("update_ratingTotal_ui",e,1)}).on("click","button.dislike",function(){var e=$(this).attr("id").slice(0,-8);amplify.publish("dislike_ui",e),amplify.publish("update_ratingTotal_ui",e,-1)}).on("click","button.liked",function(){var e=$(this).attr("id").slice(0,-5);amplify.publish("neutral_ui",e),amplify.publish("update_ratingTotal_ui",e,0)}).on("click","button.disliked",function(){var e=$(this).attr("id").slice(0,-8);amplify.publish("neutral_ui",e),amplify.publish("update_ratingTotal_ui",e,0)}),amplify.subscribe("neutral_ui",function(e){console.log("neutral_ui");var t=e.concat("_like"),i=e.concat("_dislike");$("#"+t).removeClass("liked").addClass("like"),$("#"+i).removeClass("disliked").addClass("dislike")}),amplify.subscribe("dislike_ui",function(e){console.log("dislike_ui");var t=e.concat("_like"),i=e.concat("_dislike");$("#"+t).removeClass("liked").addClass("like"),$("#"+i).removeClass("dislike").addClass("disliked")}),amplify.subscribe("like_ui",function(e){console.log("like_ui");var t=e.concat("_like"),i=e.concat("_dislike");$("#"+t).removeClass("like").addClass("liked"),$("#"+i).removeClass("disliked").addClass("dislike")}),amplify.subscribe("update_ratingTotal_ui",function(e,t){console.log("update_ratingTotal_ui"),console.log("offset : "+t);var i=e.concat("_rating"),o=e.concat("_ratingSum"),n=parseInt($("#"+i).text()),a=parseInt($("#"+o).text());console.log("ratingValue : "+n),console.log("ratingSum : "+a),-1==n?a+=1:1==n&&(a-=1),a+=t,$("#"+o).text(a),$("#"+i).text(t);var s={rating:t,articleID:e};amplify.request({resourceId:"articleReactionPOST",data:JSON.stringify(s),success:function(t,i){console.log(e+" : "+i)},error:function(e,t){console.log(t)}})}),$("#commentList").on("click","i.comment_like",function(){console.log("comment_like");var e=$(this).attr("id").slice(0,-5);amplify.publish("comment_like_ui",e),amplify.publish("update_commentRatingTotal_ui",e,1)}).on("click","i.comment_dislike",function(){var e=$(this).attr("id").slice(0,-8);amplify.publish("comment_dislike_ui",e),amplify.publish("update_commentRatingTotal_ui",e,-1)}).on("click","i.comment_liked",function(){var e=$(this).attr("id").slice(0,-5);amplify.publish("comment_neutral_ui",e),amplify.publish("update_commentRatingTotal_ui",e,0)}).on("click","i.comment_disliked",function(){var e=$(this).attr("id").slice(0,-8);amplify.publish("comment_neutral_ui",e),amplify.publish("update_commentRatingTotal_ui",e,0)}).on("click",".commentReplyButton",function(){amplify.publish("close_all_comment_reply_input"),amplify.publish("show_comment_reply_input",this.id)}).on("click",".sub_comment_cancel",function(){amplify.publish("close_all_comment_reply_input")}).on("click",".sub_comment_submit",function(){amplify.publish("add_sub_comment",this.id,$("#"+this.id+"_subCommentText").val())}).on("click",".hotShowMoreSubComments",function(){var e=$(".comment_submit").attr("id"),t=$(this).attr("id"),i="#"+t+"_subCommentList";amplify.request("hotShowMoreSubCommentsGET",{commentID:t,articleID:e},function(e){$(i).html(e)})}),$(".comment_submit").click(function(){amplify.publish("add_comment",this.id,$("#comment_text").val())}),$("#modal_comment_edit_content").on("click",".comment_edit_submit",function(){amplify.publish("edit_comment",this.id,$("#"+this.id+"_edited_content").val())}),amplify.subscribe("add_comment",function(e,t){console.log("add_comment"),console.log(e),console.log(t);var i={content:t,articleID:e};amplify.request({resourceId:"articleCommentPOST",data:JSON.stringify(i),success:function(e){console.log(e),$("#commentList").prepend(e),$("#comment_text").val("")},error:function(e){console.log(e)}})}),amplify.subscribe("add_sub_comment",function(e,t){console.log("add_sub_comment"),console.log(e),console.log(t);var i={content:t,commentID:e};amplify.request({resourceId:"subCommentPOST",data:JSON.stringify(i),success:function(t){console.log(t),$("#"+e+"_subCommentList").prepend(t),amplify.publish("close_all_comment_reply_input")},error:function(e){console.log(e)}})}),amplify.subscribe("edit_comment",function(e,t){console.log("edit_comment"),console.log(e),console.log(t);var i={content:t,commentID:e};amplify.request({resourceId:"commentPUT",data:JSON.stringify(i),success:function(i){console.log(i),amplify.publish("close_comment_edit_modal"),$("#"+e.concat("_content")).text(t)},error:function(e){console.log(e)}})}),amplify.subscribe("show_comment_reply_input",function(t){console.log("show_comment_reply_input : "+t);var i=$("#"+t.concat("_replyInput"));console.log("commentReplyInput : #"+t.concat("_replyInput")),$(i).html(Mustache.render(e,{commentID:t,avatarURL:$("#avatarURL").attr("src")}))}),amplify.subscribe("close_all_comment_reply_input",function(){console.log("close_all_comment_reply_input : "),$(".comment_reply_input_field").html("")}),amplify.subscribe("close_comment_edit_modal",function(){console.log("close_comment_edit_modal : "),$("#modal_comment_edit").modal("hide")}),amplify.subscribe("comment_neutral_ui",function(e){console.log("comment_neutral_ui");var t=e.concat("_like"),i=e.concat("_dislike");$("#"+t).removeClass("comment_liked").addClass("comment_like"),$("#"+i).removeClass("comment_disliked").addClass("comment_dislike")}),amplify.subscribe("comment_dislike_ui",function(e){console.log("comment_dislike_ui");var t=e.concat("_like"),i=e.concat("_dislike");$("#"+t).removeClass("comment_liked").addClass("comment_like"),$("#"+i).removeClass("comment_dislike").addClass("comment_disliked")}),amplify.subscribe("comment_like_ui",function(e){console.log("comment_like_ui");var t=e.concat("_like"),i=e.concat("_dislike");$("#"+t).removeClass("comment_like").addClass("comment_liked"),$("#"+i).removeClass("comment_disliked").addClass("comment_dislike")}),amplify.subscribe("update_commentRatingTotal_ui",function(e,t){console.log("update_commentRatingTotal_ui"),console.log("offset : "+t);var i=e.concat("_rating"),o=e.concat("_ratingSum"),n=parseInt($("#"+i).text()),a=parseInt($("#"+o).text());console.log("ratingValue : "+n),console.log("ratingSum : "+a),-1==n?a+=1:1==n&&(a-=1),a+=t,$("#"+o).text(a),$("#"+i).text(t);var s={rating:t,commentID:e};amplify.request({resourceId:"commentReactionPOST",data:JSON.stringify(s),success:function(t,i){console.log(e+" : "+i)},error:function(e,t){console.log(t)}})}),amplify.subscribe("articleCommentPostResultHTML",function(e){console.log(e),$("#commentList").prepend(e),$("#comment_text").val("")}),$("#modal_image_full_screen").on("show.bs.modal",function(e){var t=$(e.relatedTarget).data("image-url");$("#modal_image_full_screen_src").attr("src",t)}),$("#modal_comment_edit").on("show.bs.modal",function(e){var i=$(e.relatedTarget).data("comment-id"),o=$("#"+i+"_content").text();$("#modal_comment_edit_content").html(Mustache.render(t,{commentID:i,avatarURL:$("#avatarURL").attr("src"),content:o}))}),$("#auth_button").click(function(){var e=$("#auth_email").val(),t=$("#auth_password").val(),i=$("#auth_remember_me").is(":checked"),o={email:e,password:t,rememberMe:i};amplify.request({resourceId:"auth#signIn",data:JSON.stringify(o),success:function(e,t){console.log(t),amplify.store("_auth_token",t.token)},error:function(e,t){console.log(t)}})}),$("#hotShowMoreArticles").on("click",function(){var e=parseInt($("#hotArticlesPageNumber").val())+1;amplify.request("hotShowMoreArticlesGET",{pageNumber:e},function(t){$("#contentList").append(t),$("#hotArticlesPageNumber").val(e),amplify.publish("remove_duplicate_article_items")})}),$("#newShowMoreArticles").on("click",function(){var e=parseInt($("#newArticlesPageNumber").val())+1;amplify.request("newShowMoreArticlesGET",{pageNumber:e},function(t){$("#contentList").append(t),$("#newArticlesPageNumber").val(e),amplify.publish("remove_duplicate_article_items")})}),$("#newShowMoreUserArticles").on("click",function(){var e=parseInt($("#newArticlesPageNumber").val())+1,t=$("#otherUserProfileID").val();amplify.request("newShowMoreUserArticlesGET",{pageNumber:e,userID:t},function(t){$("#contentList").append(t),$("#newArticlesPageNumber").val(e),amplify.publish("remove_duplicate_article_items")})}),$("#hotShowMoreComments").on("click",function(){var e=parseInt($("#hotCommentsPageNumber").val())+1,t=$(".comment_submit").attr("id");amplify.request("hotShowMoreCommentsGET",{pageNumber:e,articleID:t},function(t){$("#commentList").append(t),$("#hotCommentsPageNumber").val(e),amplify.publish("remove_duplicate_comment_items")})}),amplify.subscribe("remove_duplicate_article_items",function(){console.log("remove_duplicate_article_items"),$(".post").each(function(){var e=$('[id="'+this.id+'"]');e.slice(1).remove()})}),amplify.subscribe("remove_duplicate_comment_items",function(){console.log("remove_duplicate_comment_items"),$(".comment_wrapper").each(function(){var e=$('[id="'+this.id+'"]');e.slice(1).remove()})}),amplify.subscribe("minuteHouseKeeping",function(){o&&o.send("ws_send_minuteHouseKeeping"),console.log("minuteHouseKeeping")}),setInterval(function(){amplify.publish("minuteHouseKeeping")},6e5),amplify.subscribe("user_notification_list_refresh",function(){console.log("user_notification_list_sub");var e=amplify.store.sessionStorage("user_notification_list"),t=0;for(var o in e)e[o].read||t++;$("#user_notification_list").html(Mustache.render(i,{data:e})),$("#user_notification_count").html(t)}),amplify.subscribe("user_notification_list_new",function(e){console.log("user_notification_list_new");var t=amplify.store.sessionStorage("user_notification_list"),i=!1;for(var o in t)if(t[o].id==e.id){t[o]=e,i=!0;break}i||(t=[e].concat(t)),amplify.store.sessionStorage("user_notification_list",t),amplify.publish("user_notification_list_refresh")});var o,n=$("body").data("ws-url-admin-dashboard");return n?(o=new WebSocket(n),o.onmessage=function(e){var t;return t=JSON.parse(e.data),console.log(t.messageType),console.log(t.data),"user_notification_list"===t.messageType.toLowerCase()?(amplify.store.sessionStorage("user_notification_list",t.data),amplify.publish("user_notification_list_refresh")):"user_notification"===t.messageType.toLowerCase()&&amplify.publish("user_notification_list_new",t.data),t},$("#msgform").submit(function(e){return e.preventDefault(),console.log($("#msgtext").val()),o.send($("#msgtext").val()),$("#msgtext").val("")})):void 0}),$(document).ready(function(){});